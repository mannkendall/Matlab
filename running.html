

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Running mannkendall (Matlab) &mdash; mannkendall (Matlab)  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Troubleshooting" href="troubleshooting.html" />
    <link rel="prev" title="Installation" href="installation.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> mannkendall (Matlab)
          

          
          </a>

          
            
            
              <div class="version">
                1.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference external" href="https://mannkendall.github.io/">Home</a></li>
<li class="toctree-l1"><a class="reference external" href="https://mannkendall.github.io/about.html">Spirit of mannkendall</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html">Matlab</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Running mannkendall (Matlab)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#function-description">Function description:</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#input">INPUT:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#output">OUTPUT:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="acknowledge.html">Acknowledging mannkendall (Matlab)</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/MannKendall/Matlab">Github repository</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">mannkendall (Matlab)</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Running mannkendall (Matlab)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/running.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="running-name">
<h1>Running mannkendall (Matlab)<a class="headerlink" href="#running-name" title="Permalink to this headline">¶</a></h1>
<p>The main function to compute the Mann-Kendall test with the desired prewhitening method, temporal
segmentation and confidence limit is:</p>
<div class="highlight-Matlab notranslate"><div class="highlight"><pre><span></span><span class="n">result</span><span class="p">=</span><span class="n">MK_tempAggr</span><span class="p">(</span><span class="n">data_tempAgg</span><span class="p">,</span> <span class="n">resolution</span><span class="p">,</span> <span class="n">varargin</span><span class="p">)</span>
</pre></div>
</div>
<p>For example:</p>
<p>How to call the function:</p>
<div class="highlight-Matlab notranslate"><div class="highlight"><pre><span></span><span class="n">result</span><span class="p">=</span><span class="n">MK_tempAggr</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">);</span>
<span class="n">result</span><span class="p">=</span><span class="n">MK_tempAggr</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> ‘<span class="n">PW_method</span>’<span class="p">,</span>’<span class="n">TFPW_WS</span>’<span class="p">,</span>’<span class="n">alpha_MK</span>’<span class="p">,</span><span class="mi">99</span><span class="p">,</span>’<span class="n">alpha_ak</span>’<span class="p">,</span><span class="mi">95</span><span class="p">,</span> ‘<span class="n">alpha_CL</span>’<span class="p">,</span><span class="mi">95</span><span class="p">,</span> ‘<span class="n">alpha_Xhomo</span>’<span class="p">,</span><span class="mi">90</span><span class="p">);</span>
</pre></div>
</div>
<p>An exemple without temporal aggregation:</p>
<div class="highlight-Matlab notranslate"><div class="highlight"><pre><span></span><span class="n">test_data</span><span class="p">=</span><span class="n">timetable</span><span class="p">(</span><span class="n">datetime</span><span class="p">(</span><span class="n">datevec</span><span class="p">([</span><span class="n">datenum</span><span class="p">([</span><span class="mi">2000</span> <span class="mi">01</span> <span class="mi">01</span><span class="p">]):</span><span class="mi">365</span><span class="p">:</span><span class="n">datenum</span><span class="p">([</span><span class="mi">2010</span> <span class="mi">01</span> <span class="mi">01</span><span class="p">])])));</span>
<span class="n">test_datay</span><span class="p">.</span><span class="n">param</span><span class="p">=[</span><span class="mf">1.92</span> <span class="mf">2.28</span> <span class="mf">2.71</span> <span class="mf">2.89</span> <span class="mf">2.82</span> <span class="mf">4.02</span> <span class="mf">3.25</span> <span class="mf">3.49</span> <span class="mf">4.94</span> <span class="mf">3.75</span> <span class="mf">3.25</span><span class="p">]</span><span class="o">&#39;</span><span class="p">;</span>
<span class="n">test_resulty</span><span class="p">=</span><span class="n">MK_tempAggr</span><span class="p">(</span><span class="n">test_datay</span><span class="p">,</span><span class="mf">0.001</span><span class="p">)</span>

<span class="n">test_resulty</span> <span class="p">=</span>

<span class="n">struct</span> <span class="s">with</span> <span class="s">fields:</span>

<span class="n">P</span><span class="p">:</span> <span class="mf">0.0077</span>
<span class="n">ss</span><span class="p">:</span> <span class="mi">95</span>
<span class="n">slope</span><span class="p">:</span> <span class="mf">0.1861</span>
<span class="n">UCL</span><span class="p">:</span> <span class="mf">0.3052</span>
<span class="n">LCL</span><span class="p">:</span> <span class="mf">0.1301</span>
</pre></div>
</div>
<p>An exemple with a temporal segmentation into 4 quartals:</p>
<div class="highlight-Matlab notranslate"><div class="highlight"><pre><span></span><span class="n">test_data_sea1</span><span class="p">=</span><span class="n">timetable</span><span class="p">(</span><span class="n">datetime</span><span class="p">(</span><span class="n">datevec</span><span class="p">([</span><span class="n">datenum</span><span class="p">([</span><span class="mi">2000</span> <span class="mi">01</span> <span class="mi">01</span><span class="p">]):</span><span class="mi">365</span><span class="p">:</span><span class="n">datenum</span><span class="p">([</span><span class="mi">2018</span> <span class="mi">01</span> <span class="mi">01</span><span class="p">])])));</span>
<span class="n">test_data_sea2</span><span class="p">=</span><span class="n">timetable</span><span class="p">(</span><span class="n">datetime</span><span class="p">(</span><span class="n">datevec</span><span class="p">([</span><span class="n">datenum</span><span class="p">([</span><span class="mi">2000</span> <span class="mi">04</span> <span class="mi">01</span><span class="p">]):</span><span class="mi">365</span><span class="p">:</span><span class="n">datenum</span><span class="p">([</span><span class="mi">2018</span> <span class="mi">04</span> <span class="mi">01</span><span class="p">])])));</span>
<span class="n">test_data_sea3</span><span class="p">=</span><span class="n">timetable</span><span class="p">(</span><span class="n">datetime</span><span class="p">(</span><span class="n">datevec</span><span class="p">([</span><span class="n">datenum</span><span class="p">([</span><span class="mi">2000</span> <span class="mi">07</span> <span class="mi">01</span><span class="p">]):</span><span class="mi">365</span><span class="p">:</span><span class="n">datenum</span><span class="p">([</span><span class="mi">2018</span> <span class="mi">07</span> <span class="mi">01</span><span class="p">])])));</span>
<span class="n">test_data_sea4</span><span class="p">=</span><span class="n">timetable</span><span class="p">(</span><span class="n">datetime</span><span class="p">(</span><span class="n">datevec</span><span class="p">([</span><span class="n">datenum</span><span class="p">([</span><span class="mi">2000</span> <span class="mi">10</span> <span class="mi">01</span><span class="p">]):</span><span class="mi">365</span><span class="p">:</span><span class="n">datenum</span><span class="p">([</span><span class="mi">2018</span> <span class="mi">10</span> <span class="mi">01</span><span class="p">])])));</span>

<span class="n">test_data_sea1</span><span class="p">.</span><span class="n">param</span><span class="p">=[</span> <span class="mf">3.20</span> <span class="mf">2.92</span> <span class="mf">3.95</span> <span class="mf">1.80</span> <span class="mf">2.45</span> <span class="mf">2.70</span> <span class="mf">2.22</span> <span class="mf">2.10</span> <span class="mf">2.08</span> <span class="mf">2.21</span> <span class="mf">1.93</span> <span class="mf">2.15</span> <span class="mf">2.03</span> <span class="mf">1.82</span> <span class="mf">1.94</span> <span class="mf">2.24</span> <span class="mf">1.67</span> <span class="mf">1.34</span> <span class="mf">1.61</span><span class="p">]</span><span class="o">&#39;</span><span class="p">;</span>
<span class="n">test_data_sea2</span><span class="p">.</span><span class="n">param</span><span class="p">=[</span><span class="mf">3.92</span> <span class="mf">2.99</span> <span class="mf">4.37</span> <span class="mf">3.04</span> <span class="mf">3.12</span> <span class="mf">4.07</span> <span class="mf">3.91</span> <span class="mf">3.42</span> <span class="mf">2.94</span> <span class="mf">3.14</span> <span class="mf">2.53</span> <span class="mf">2.80</span> <span class="mf">2.98</span> <span class="mf">2.86</span> <span class="mf">3.22</span> <span class="mf">2.31</span> <span class="mf">2.03</span> <span class="mf">1.59</span> <span class="mf">2.14</span><span class="p">]</span><span class="o">&#39;</span><span class="p">;</span>
<span class="n">test_data_sea3</span><span class="p">.</span><span class="n">param</span><span class="p">=[</span><span class="mf">4.56</span> <span class="mf">4.13</span> <span class="mf">4.31</span> <span class="mf">1.83</span> <span class="mf">3.22</span> <span class="mf">5.06</span> <span class="mf">4.39</span> <span class="mf">4.13</span> <span class="mf">4.06</span> <span class="mf">3.20</span> <span class="mf">4.01</span> <span class="mf">3.62</span> <span class="mf">3.78</span> <span class="mf">3.61</span> <span class="mf">3.42</span> <span class="mf">3.65</span> <span class="mf">2.39</span> <span class="mf">3.01</span> <span class="mf">3.03</span><span class="p">]</span><span class="o">&#39;</span><span class="p">;</span>
<span class="n">test_data_sea4</span><span class="p">.</span><span class="n">param</span><span class="p">=[</span><span class="mf">4.22</span> <span class="mf">4.78</span> <span class="mf">2.96</span> <span class="mf">3.23</span> <span class="mf">2.82</span> <span class="mf">2.96</span> <span class="mf">3.12</span> <span class="mf">3.49</span> <span class="mf">2.73</span> <span class="mf">2.61</span> <span class="mf">3.00</span> <span class="mf">2.66</span> <span class="mf">3.49</span> <span class="mf">2.58</span> <span class="mf">2.32</span> <span class="mf">2.10</span> <span class="mf">2.38</span> <span class="mf">2.29</span> <span class="mf">2.07</span><span class="p">]</span><span class="o">&#39;</span><span class="p">;</span>

<span class="n">test_data_seax</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">obs</span><span class="p">=</span><span class="n">test_data_sea1</span><span class="p">;</span>
<span class="n">test_data_seax</span><span class="p">(</span><span class="mi">2</span><span class="p">).</span><span class="n">obs</span><span class="p">=</span><span class="n">test_data_sea2</span><span class="p">;</span>
<span class="n">test_data_seax</span><span class="p">(</span><span class="mi">3</span><span class="p">).</span><span class="n">obs</span><span class="p">=</span><span class="n">test_data_sea3</span><span class="p">;</span>
<span class="n">test_data_seax</span><span class="p">(</span><span class="mi">4</span><span class="p">).</span><span class="n">obs</span><span class="p">=</span><span class="n">test_data_sea4</span><span class="p">;</span>
<span class="n">test_result_sea</span><span class="p">=</span><span class="n">MK_tempAggr</span><span class="p">(</span><span class="n">test_data_seax</span><span class="p">,</span><span class="mf">0.001</span><span class="p">);</span>
</pre></div>
</div>
<table class="colwidths-auto docutils align-default" id="id1">
<caption><span class="caption-text">Results</span><a class="headerlink" href="#id1" title="Permalink to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>P</p></th>
<th class="head"><p>ss</p></th>
<th class="head"><p>Slope</p></th>
<th class="head"><p>UCL</p></th>
<th class="head"><p>LCL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1st quartal</p></td>
<td><p>0.0280</p></td>
<td><p>95</p></td>
<td><p>-0.0631</p></td>
<td><p>-0.0272</p></td>
<td><p>-0.0888</p></td>
</tr>
<tr class="row-odd"><td><p>2nd quartal</p></td>
<td><p>0.0051</p></td>
<td><p>95</p></td>
<td><p>-0.0947</p></td>
<td><p>-0.0452</p></td>
<td><p>-0.1599</p></td>
</tr>
<tr class="row-even"><td><p>3rd quartal</p></td>
<td><p>0.0689</p></td>
<td><p>-1</p></td>
<td><p>-0.0626</p></td>
<td><p>-0.0168</p></td>
<td><p>-0.1167</p></td>
</tr>
<tr class="row-odd"><td><p>4th quartal</p></td>
<td><p>0.0064</p></td>
<td><p>95</p></td>
<td><p>-0.0626</p></td>
<td><p>-0.0337</p></td>
<td><p>-0.1170</p></td>
</tr>
<tr class="row-even"><td><p>Year</p></td>
<td><p>1.365e-6</p></td>
<td><p>95</p></td>
<td><p>-0.029</p></td>
<td><p>-0.0304</p></td>
<td><p>-0.1168</p></td>
</tr>
</tbody>
</table>
<div class="section" id="function-description">
<h2>Function description:<a class="headerlink" href="#function-description" title="Permalink to this headline">¶</a></h2>
<p>The MK test and the Sen slope are applied on the given time granularity, temporal aggregation and
prewhitening method. Five prewhitening methods can be chosen, 3PW being the default option:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">3PW</span></code> (Collaud Coen et al., 2020): 3 prewhitening methods are applied (PW and TFPW_Y to determine the statistic significance (ss) of the MK test and the VCTFPW method to compute the Sen’s slope</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PW</span></code> (prewhitened, Kulkarni and von Storch, 1995)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TFPW_Y</span></code> (trend free PW,Yue et al., 2001)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TFPW_WS</span></code> (trend free PW, Wang and Swail, 2001)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">VCTFPW</span></code> (variance corrected trend free PW, Wang et al., 2015)</p></li>
</ul>
</div></blockquote>
<p>For the PW, only ss autocorrelation are taken into account. The default ss for the MK test is taken
at 95% confidence limit. The default ss for upper and lower confidence limits is 90% of the all
intervals differences distribution. The default ss for the autocorrelation coefficient is 95%. The
default ss for the homogeneity test between temporal aggregation of the MK test is 90%.
If seasonal Mann-Kendall is applied, the yearly trend is assigned only if the results of the seasonal test are homogeneous. The default ss for the homogeneity test between temporal aggregation of the seasonal MK test is 90%.</p>
<div class="section" id="input">
<h3>INPUT:<a class="headerlink" href="#input" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">data_tempAgg</span></code> (n_arrays)= a unique timetable if MK test without temporal aggregation has to
be used of structure of timetables if the seasonal MK test has to be applied. Each “season” is
given by one timetable in the structure. The timetable should have only one field (apart the time).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">resolution</span></code> (float)= interval to determine the number of ties. It should be similar to the
resolution of the instrument.</p></li>
<li><p>Optional input <code class="docutils literal notranslate"><span class="pre">varargin</span></code> :</p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">PW_method</span></code> (string)=  used PW method (3PW; PW, TFPW_Y, TFPW_WS, VCTFPW). Default is 3PW.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">alpha_MK</span></code> (float)= confidence limit for Mk test in %. Default value is 95%</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">alpha_CL</span></code> (float)= confidence limit for the confidence limits of the Sen’s slope in %. Default
value is 90%</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">alpha_Xhomo</span></code> (float)= confidence limit for the homogeneity between seasons in %. Default value
is 90%</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">alpha_ak</span></code> (float)= confidence limit for the first lag autocorrelation in %. Default value is 95%</p></li>
</ul>
</div></blockquote>
</div></blockquote>
</div>
<div class="section" id="output">
<h3>OUTPUT:<a class="headerlink" href="#output" title="Permalink to this headline">¶</a></h3>
<p>result (table)= comprises the following fields:</p>
<blockquote>
<div><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">result.P</span></code> (float): probability for the statistical significance. If 3PW is applied,
P= max(P_PW, P_TFPW_Y);</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">result.ss</span></code> (float)= statistical significance:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">alpha_MK</span></code> if the test is ss at the alpha confidence level. Default=95%</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">0</span></code> if the test is not ss at the alpha_MK confidence level</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-1</span></code> if the test is a TFPW_Y fals epositive at alpha_MK confidence level</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-2</span></code> if the test is a PW false positive at alpha_MK confidence level</p></li>
</ul>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">result.slope</span></code> (float): Sen’s slope in units/y</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">result.UCL</span></code> (float): upper confidence level in units/y</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">result.LCL</span></code> (float): lower confidence level in units/y</p></li>
</ul>
</div></blockquote>
<p><strong>Sources:</strong></p>
<blockquote>
<div><ul class="simple">
<li><p>Collaud Coen et al., Effects of the prewhitening method, the time granularity and the time segmentation on the Mann-Kendall trend detection and the associated Sen’s slope,  Atmos. Meas. Tech. Discuss,https://doi.org/10.5194/amt-2020-178, in review, 2020.</p></li>
<li><p>Sirois, A.: A brief and biased overview of time-series analysis of how to find that evasive trend, WMO/EMEP Workshop on Advanced Statistical Methods and Their Application to Air Quality Data Sets, Annex E., Global Atmosphere Watch No. 133, TD- No. 956, World Meteorological Organization, Geneva, Switzerland, 1998. annexe E, p. 26</p></li>
<li><p>Gilbert, R.: Statistical Methods for Environmental Pollution Monitoring, Van Nostrand Reinhold Company, New York, 1987.
and the explanations about MULTMK/PARTMK de C. Libiseller</p></li>
</ul>
</div></blockquote>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="troubleshooting.html" class="btn btn-neutral float-right" title="Troubleshooting" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="installation.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, MeteoSwiss..

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>